
PS C:\Users\Kizito\livechatwithreact\advanced-livechat-saas> railway up
  Indexed                                                                                                                 Compressed [====================] 100%                                                                                  Uploaded                                                                                                                Build Logs: https://railway.com/project/c66a41be-9633-4791-a1c0-188ce1b5ec0b/service/4553cba6-6121-4b1c-8c69-153db4ce34dd?id=8a48ddfe-189d-4693-82e6-198bd5756dba&
Failed to stream build logs: Failed to retrieve build log
PS C:\Users\Kizito\livechatwithreact\advanced-livechat-saas> railway logs
Starting Container
ğŸš€ Starting Advanced Live Chat SaaS for Railway...
ğŸ“‹ Configuration:
  PORT: 3000
> advanced-livechat-saas@1.0.0 start:railway

> node railway-final-start.js

  NODE_ENV: production
  MONGO_URI: SET (hidden)
ğŸ“ Current working directory: /app
ğŸ“‚ Directory contents: [
  'backend',
  'deploy.js',
  'ecosystem.config.js',
  'fix-railway-db.js',
  'frontend',
  'logs',
  'node_modules',
  'package-lock.json',
  'package.json',
  'railway-final-start.js',
  'railway-startup.js',
  'single-url-deploy-improved.js'
]
ğŸ” Checking path: /app/frontend/dist
âœ… Frontend found at: /app/frontend/dist
âœ… Using frontend at: /app/frontend/dist
âœ… Frontend is built
ğŸ”§ Running database fix...
DB FIX: ğŸš‚ Railway Database Fix - Direct Execution
  - routes
  - middlewares
  - migrations
  - models
  - node_modules
  - single-url-deploy-improved.js
  - package-lock.json
ğŸ“ Backend directory contents:
  - package.json
DB FIX: - .env.example
  - README_BACKEND.md
  - check-mongo-simple.js
  - config
DB FIX: - controllers
DB FIX: - db-fix-endpoint.js
  - knexfile-fixed.js
  - knexfile-postgresql.js
  - knexfile.js
DB FIX: ğŸ“… Timestamp: 2025-12-09T07:55:12.476Z
ğŸ“ Working directory: /app
DB FIX: ğŸ“‚ Directory contents:
  - backend
  - deploy.js
  - ecosystem.config.js
  - fix-railway-db.js
  - frontend
DB FIX: - logs
  - node_modules
  - package-lock.json
  - package.json
  - railway-final-start.js
  - railway-startup.js
  - seeds
  - server-fixed.js
  - server-single-url.js
  - server.js
  - server_optimized.js
  - services
  - test-mongo-quick.js
  - test-mongodb-complete.js
  - test-mongodb.js
  - utils
ğŸ“„ Database path: /app/backend/dev.sqlite3
âŒ Database file does not exist, will create

ğŸš€ Executing database fix...
DB FIX: ğŸ”§ Starting database fix...
ğŸ“Š Checking current tables...
DB FIX: âœ… Connected to SQLite database
DB FIX: Current tables: []
âŒ Users table missing, will create

ğŸ”¨ Creating users table...
DB FIX: âœ… SQL executed successfully
DB FIX: Rows affected: 0

ğŸ”¨ Creating sites table...
DB FIX: âœ… SQL executed successfully
   Rows affected: 0
DB FIX: ğŸ”¨ Creating visitors table...
DB FIX: âœ… SQL executed successfully
DB FIX: Rows affected: 0

ğŸ”¨ Creating payments table...
DB FIX: âœ… SQL executed successfully
DB FIX: Rows affected: 0

ğŸ‘¤ Inserting default admin user...
DB FIX: âœ… SQL executed successfully
DB FIX: Rows affected: 1

ğŸ‘¤ Inserting demo user...
DB FIX: âœ… SQL executed successfully
   Rows affected: 1
DB FIX: ğŸŒ Inserting default sites...
DB FIX: âœ… SQL executed successfully
DB FIX: Rows affected: 2

âœ… Verifying final data...
DB FIX: ğŸ“Š Final results:
   Users count: 2
   Sites count: 2
DB FIX: Admin user: {
  id: 1,
  email: 'admin@example.com',
  name: 'Admin User',
  role: 'admin'
}

ğŸ‰ Database fix completed successfully!
âœ… Admin login should now work:
   Email: admin@example.com
DB FIX: Password: admin123

ğŸ‰ SUCCESS: Database has been fixed!
ğŸ§ª You can now test the login with:
   Email: admin@example.com
   Password: admin123
Database fix exited with code 0
ğŸ¯ Starting backend server from: /app/backend/server.js
SERVER: âœ… sites table exists
SERVER: âœ… visitors table exists
SERVER: âœ… payments table exists
SERVER: ğŸ‘¤ Inserting default SQLite users...
SERVER ERROR: âŒ Failed to parse DATABASE_URL: parse is not defined
âœ… Server appears to be running
SERVER: ğŸ¯ Demo page: http://localhost:3000/demo.html
SERVER ERROR: âŒ Database connection failed for models: parse is not defined
SERVER: ğŸ’¾ Falling back to SQLite for models...
SERVER: âœ… SQLite database connected
SERVER: ğŸ”§ Initializing SQLite database...
SERVER: ğŸ”§ Database configured for production environment
SERVER: ğŸ“Š Current tables: [ 'users', 'sqlite_sequence', 'sites', 'visitors', 'payments' ]
SERVER: âœ… SQLite fallback loaded for models
SERVER: ğŸ˜ Using PostgreSQL connection
SERVER: âœ… users table exists
âœ… Database provider initialized with sqlite
SERVER: ğŸ”„ Connecting to MongoDB...
SERVER: ğŸš€ Advanced Live Chat SaaS server running on port 3000
SERVER: ğŸ˜ Attempting PostgreSQL connection for models...
ğŸ“Š Dashboard: http://localhost:3000/dashboard
SERVER: âœ… Default SQLite users inserted
SERVER: ğŸ‰ SQLite initialization completed!
SERVER: [2025-12-09T07:55:14.325Z] GET /health
SERVER: âœ… MongoDB connected successfully to Atlas!
ğŸ“Š Database: advanced-livechat
SERVER: âœ… MongoDB connection verified
ğŸ”§ Creating indexes...
SERVER: âœ… Indexes created successfully
SERVER: ğŸ“‹ MongoDB Version: 8.0.16
ğŸ  Host: ac-xgidsaq-shard-00-02.tjk5ezx.mongodb.net:27017
SERVER: [2025-12-09T07:55:18.736Z] GET /health
âœ… Health check passed: {
  status: 'ok',
  timestamp: '2025-12-09T07:55:18.737Z',
  database: 'sqlite',
  mongodb: 'configured'
}
ğŸ‰ Application ready at http://localhost:3000
ğŸŒ Health endpoint: http://localhost:3000/health
SERVER: [2025-12-09T07:55:46.714Z] GET /health
SERVER ERROR: âŒ JSON Parse Error: {
  message: 'Unexpected token e in JSON at position 1',
  body: '{email:admin@example.com,password:admin123}',
  path: '/api/auth/login',
  method: 'POST',
  headers: {
    host: 'talkavax-production.up.railway.app',
    'user-agent': 'curl/8.0.1',
    'content-length': '43',
    accept: '*/*',
    'content-type': 'application/json',
    'x-forwarded-for': '102.90.80.143',
    'x-forwarded-host': 'talkavax-production.up.railway.app',
    'x-forwarded-proto': 'https',
    'x-railway-edge': 'railway/europe-west4-drams3a',
    'x-railway-request-id': 'S2Cmb5yaRJ2WO69Lm3z_FQ',
    'x-real-ip': '102.90.80.143',
    'x-request-start': '1765266999787',
    'accept-encoding': 'gzip'
  }
}
    'x-real-ip': '102.90.80.143',
    'x-request-start': '1765267721171',
    'accept-encoding': 'gzip'
  }
}
SERVER ERROR: âŒ JSON Parse Error: {
  message: 'Unexpected token e in JSON at position 1',
  body: '{email:admin@example.com,password:admin123}',
  path: '/api/auth/login',
  method: 'POST',
  headers: {
    host: 'talkavax-production.up.railway.app',
    'user-agent': 'curl/8.0.1',
    'content-length': '43',
    accept: '*/*',
    'content-type': 'application/json',
    'x-forwarded-for': '102.90.80.143',
    'x-forwarded-host': 'talkavax-production.up.railway.app',
    'x-forwarded-proto': 'https',
    'x-railway-edge': 'railway/europe-west4-drams3a',
    'x-railway-request-id': '_gxxxy9yRpG6iU_arJsmnA',
SERVER: [2025-12-09T08:09:43.757Z] GET /health
SERVER ERROR: âŒ JSON Parse Error: {
  message: "Unexpected token ' in JSON at position 0",
  body: "'{email:admin@example.com,password:admin123}'",
  path: '/api/auth/login',
  method: 'POST',
  headers: {
    host: 'talkavax-production.up.railway.app',
    'user-agent': 'curl/8.0.1',
    'content-length': '45',
    accept: '*/*',
    'content-type': 'application/json',
    'x-forwarded-for': '102.90.80.143',
    'x-forwarded-host': 'talkavax-production.up.railway.app',
    'x-forwarded-proto': 'https',
    'x-railway-edge': 'railway/europe-west4-drams3a',
    'x-railway-request-id': 'CUg8IDolTsKe4CyeN8N_Fg',
    'x-real-ip': '102.90.80.143',
    'x-request-start': '1765267962127',
    'accept-encoding': 'gzip'
  }
}
SERVER: [2025-12-09T08:12:50.587Z] POST /api/auth/login
ğŸ“‹ Content-Type: application/json
ğŸ“ Content-Length: 51
SERVER: [2025-12-09T08:17:04.012Z] GET /health
SERVER: [2025-12-09T08:29:56.762Z] POST /api/auth/login
ğŸ“‹ Content-Type: application/json
ğŸ“ Content-Length: 51